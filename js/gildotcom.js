var gildotcom={currentIndex:0,cartoonSteps:["start","developer","hotwife","homerepair","bbq","workout","workoutfat","end"],flipping:false,doItAgain:[],container:$("#intro"),showNextPage:function(){if(this.doItAgain.length>3){this.settleDown();return}this.currentIndex++;if(this.currentIndex===this.cartoonSteps.length)this.currentIndex=0;var a=this.cartoonSteps[this.currentIndex];nextPage=$("div."+a,this.container);if(nextPage.length<1){this.tmplFromUrl("pages/"+a+".html",null,function(a){nextPage=a.appendTo(gildotcom.container);gildotcom.flipPages(nextPage)})}else{this.flipPages(nextPage)}},tmplFromUrl:function(a,b,c,d,e){$.get(a,function(a){var f=$.tmpl(a,b,d,e);c(f)})},flip:function(a,b){var c=new $.Deferred;a.animate({left:b},1500,c.resolve);return c.promise()},flipPages:function(a){if(this.flipping){this.doItAgain.push(a);return}this.flipping=true;$.when(gildotcom.flip($("div.current",this.container),"-800px")).then(gildotcom.flip(a,"0px")).then(function(){$("div.current",this.container).removeClass("current").css("left","800px");a.addClass("current");gildotcom.flipping=false;if(gildotcom.doItAgain.length){gildotcom.flipPages(gildotcom.doItAgain.shift())}})},settleDown:function(){this.tmplFromUrl("../pages/settle.html",null,function(a){$("#content").append(a);$("div.settle").delay(2e3).fadeOut(1500)})},init:function(){$("a.next").bind("click",function(a){a.preventDefault();gildotcom.showNextPage()});$(document).bind("keypress",function(a){if(a.keyCode==39){gildotcom.showNextPage()}});$("<img/>")[0].src="images/arrow-h.png"}}